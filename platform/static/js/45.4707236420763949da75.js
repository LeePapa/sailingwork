webpackJsonp([45],{"+ywM":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("p3rM"),i={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"staff-table"}},[s("div",{staticClass:"staff-tree change-tree-default"},[s("div",{staticClass:"change-tree-default",style:{height:e.height}},[s("el-tree",{ref:"tree",style:{height:e.height},attrs:{data:e.staffTree,props:e.defaultProps,"default-expand-all":"","highlight-current":e.isHighlight,"render-content":e.renderContent,"node-key":"label","default-current-key":"部门管理"},on:{"current-change":e.currentChange,"node-click":e.handleNodeClick,"node-expand":e.nodeExpand,"node-collapse":e.nodeExpand}})],1)]),e._v(" "),s("div",{staticClass:"staff-table",style:{height:e.height}},[s("div",{staticClass:"search-content"},[s("span",[e._v("姓名")]),e._v(" "),s("el-input",{attrs:{placeholder:"请输入姓名"},model:{value:e.searchName,callback:function(t){e.searchName=t},expression:"searchName"}}),e._v(" "),s("span",[e._v("状态")]),e._v(" "),s("el-select",{model:{value:e.searchStatus,callback:function(t){e.searchStatus=t},expression:"searchStatus"}},e._l(e.statusArr,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),s("div",{staticClass:"search-btn",on:{click:e.searchMethods}},[e._v("搜索")])],1),e._v(" "),s("el-table",{staticStyle:{width:"100%"},attrs:{border:"",height:e.tableHeight,data:e.staffList,stripe:""},on:{"sort-change":e.sort}},[s("el-table-column",{attrs:{prop:"platformer_id",label:"员工编号",align:"center","min-width":"10%",sortable:"true"}}),e._v(" "),s("el-table-column",{attrs:{prop:"pl_name",label:"姓名",align:"center","min-width":"10%","show-overflow-tooltip":""}}),e._v(" "),s("el-table-column",{attrs:{prop:"phone",label:"登录手机号",align:"center","min-width":"11%"}}),e._v(" "),s("el-table-column",{attrs:{prop:"pl_department_name",label:"部门",align:"center","min-width":"8%","show-overflow-tooltip":""}}),e._v(" "),s("el-table-column",{attrs:{prop:"pl_position_name",label:"职位",align:"center","min-width":"8%","show-overflow-tooltip":""}}),e._v(" "),s("el-table-column",{attrs:{prop:"remark",label:"备注",align:"center","min-width":"20%","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.remark?s("span",{attrs:{size:"small","min-width":"20%"}},[e._v(e._s(t.row.remark)+"\n          ")]):s("span",{attrs:{size:"small"}},[e._v("--\n          ")])]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"is_freeze",label:"状态",align:"center","min-width":"7%",sortable:"true"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.is_freeze===e.isNoFreezed?s("span",{attrs:{size:"small"}},[e._v("启用\n          ")]):s("span",{attrs:{size:"small"}},[e._v("冻结\n          ")])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作","min-width":"25%",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.is_freeze===e.isNoFreezed?s("span",{staticClass:"text-red",attrs:{size:"small",type:"info"},on:{click:function(a){e.handleModifyStatus(t.row,1)}}},[e._v("冻结\n          ")]):s("span",{staticClass:"text-green",attrs:{size:"small",type:"success"},on:{click:function(a){e.handleModifyStatus(t.row,0)}}},[e._v("启用\n          ")]),e._v(" "),s("router-link",{attrs:{to:{path:"/organziteList/cantEditStaffDetail",query:{platformer_id:t.row.platformer_id,activIndex:"1",choosed_depart_id:e.choosedDepartId,choosed_depart_name:e.choosedDepartName}}}},[s("span",{staticClass:"text-blue",attrs:{size:"small",type:"text"}},[e._v("查看\n            ")])]),e._v(" "),s("router-link",{attrs:{to:{path:"/organziteList/editStaffDetail",query:{platformer_id:t.row.platformer_id,activIndex:"1",choosed_depart_id:e.choosedDepartId,choosed_depart_name:e.choosedDepartName}}}},[s("span",{staticClass:"text-blue",attrs:{size:"small",type:"text"}},[e._v("编辑\n            ")])]),e._v(" "),s("span",{staticClass:"text-red",attrs:{size:"small",type:"text"},on:{click:function(a){e.handleDeleteBtn(t.row)}}},[e._v("删除\n          ")])]}}])})],1),e._v(" "),s("div",{staticClass:"page"},[s("div",{staticClass:"pagination-content"},[s("el-pagination",{staticClass:"page-el",attrs:{"current-page":e.listQuery.page,"page-sizes":[10,20,40],"page-size":e.listQuery.limit,layout:"sizes, jumper, prev, pager, next",total:e.total},on:{"update:currentPage":function(t){e.$set(e.listQuery,"page",t)},"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1)]),e._v(" "),e.isListEmpty?s("div",{staticClass:"data-empty"},[0==e.searchNone?s("div",{staticClass:"img"},[s("img",{attrs:{src:a("A+eB")}}),e._v(" "),s("div",{staticClass:"text-center"},[e._v("暂无数据...")])]):e._e(),e._v(" "),1==e.searchNone?s("div",{staticClass:"img"},[s("img",{attrs:{src:a("Fd8H")}}),e._v(" "),s("div",{staticClass:"text-center"},[e._v("暂无搜索数据...")])]):e._e()]):e._e()],1),e._v(" "),e.isOperate?s("operate-dialog",{attrs:{operateText:e.operateText,operateSuccessTxt:e.operateSuccessTxt,isShowRedBtn:e.isShowRedBtn,operateFailTxt:e.operateFailTxt},on:{dialogClose:e.dialogClose,confimOper:e.confimOper}}):e._e(),e._v(" "),e.isDetailDialog?s("detail-dialog",{attrs:{departmentName:e.departmentName,suOrfa:e.suOrfa,tipsText:e.tipsText,repeat:e.repeat},on:{confirmAdd:e.confirmAdd,handleClose:e.dialogClose}}):e._e()],1)},staticRenderFns:[]};var r=function(e){a("vBJn"),a("L1xO")},n=a("X4nt")(s.a,i,!1,r,"data-v-76aa9d36",null);t.default=n.exports},L1xO:function(e,t){},p3rM:function(e,t,a){"use strict";(function(e){var s=a("6nXL"),i=a("ihY9"),r=a("HPzi"),n=a("+vDi"),o=a("pMNc"),h=a("nMBb"),l=a("swMD");t.a={data:function(){return{newName:"",newDpaId:"",isOperate:!1,isListEmpty:!1,searchNone:!1,isDetailDialog:!1,suOrfa:!1,repeat:!1,isShowRedBtn:!1,isFreezeMethods:!1,isDeleDepart:!1,isSort:!1,sortLabel:"",sortOrder:1,height:0,tableHeight:0,depart_id:0,searchStatus:"",searchName:"",operateSuccessTxt:"",operateFailTxt:"",operateText:"",departmentName:"",tipsText:"",departmentId:"",operateStatus:null,operateData:{},total:0,listQuery:{page:1,limit:10},staffList:[],isHighlight:!0,staffTree:[{label:"部门管理",children:[]}],nameaa:"神奇的部落",treeNodeKey:"",statusArr:[{label:"全部",value:""},{label:s.m.toString(s.m.NO),value:s.m.NO},{label:s.m.toString(s.m.YES),value:s.m.YES}],treeDataArr:[],choosedDepartId:"",choosedDepartName:"",defaultProps:{label:"label",children:"children"}}},created:function(){var t=this;this.tableHeight=document.documentElement.clientHeight-274,this.height=document.documentElement.clientHeight-159+"px",e(window).resize(function(){t.height=document.documentElement.clientHeight-159+"px",t.tableHeight=document.documentElement.clientHeight-274}),l.a.removeItem("#OFF_ORG_FORM"),this.getStaffTree(),void 0!==this.$route.query.choosedDepartId&&""!==this.$route.query.choosedDepartId?(this.choosedDepartId=this.$route.query.choosedDepartId,this.choosedDepartName=this.$route.query.choosedDepartName,this.getDepartStaff(this.$route.query.choosedDepartId)):(this.$nextTick(function(){t.newName=t.staffTree[0].label,t.$refs.tree.setCurrentKey(t.newName),t.isHighlight=!0}),this.getStaffListpl())},computed:{isNoFreezed:function(){return s.m.NO}},watch:{treeDataArr:function(e){var t=this;this.$nextTick(function(){t.$route.query.choosedDepartName&&(t.newName=t.$route.query.choosedDepartName,t.$refs.tree.setCurrentKey(t.newName),t.isHighlight=!0)})}},components:{operateDialog:n.a,detailDialog:h.a},methods:{getStaffListpl:function(){var e=this,t={get_platformer_list:1,page_size:this.listQuery.limit,page_no:this.listQuery.page};this.searchName&&(t.pl_name=this.searchName),(this.searchStatus||0===this.searchStatus)&&(t.is_freeze=this.searchStatus),this.isSort&&(t.sort_name=this.sortLabel,t.desc=this.sortOrder),this.depart_id&&(t.pl_department_id=this.depart_id),Object(i.e)(t).then(function(t){0===t.ret&&(t.data.platformer_list&&t.data.platformer_list.length>0?(e.staffList=t.data.platformer_list,e.isListEmpty=!1,e.total=t.data.total):(e.staffList=[],e.isListEmpty=!0,!0===e.isSearch?e.searchNone=!0:e.searchNone=!1))}),this.staffList=[]},getStaffTree:function(){this.staffTree[0].children=Object(r.c)(),this.treeDataArr=this.staffTree[0].children},getDepartStaff:function(e){var t=this;this.searchName="",this.searchStatus="";var a={get_department_platformer:1,page_size:this.listQuery.limit,page_no:this.listQuery.page,pl_department_id:e};Object(i.a)(a).then(function(e){0===e.ret&&(e.data.platformer_list&&e.data.platformer_list.length>0?(t.staffList=e.data.platformer_list,t.isListEmpty=!1):(t.staffList=[],t.isListEmpty=!0,!0===t.isSearch?t.searchNone=!0:t.searchNone=!1),t.isSearch=!1)})},sort:function(e){this.sortLabel=e.prop,"descending"===e.order?(this.isSort=!0,this.sortOrder=-1):"ascending"===e.order?(this.isSort=!0,this.sortOrder=1):this.isSort=!1,this.searchName="",this.searchStatus="",this.getStaffListpl()},FreezeStaffMethods:function(){var e=this,t={platformer_freeze:1,platformer_id:this.operateData.platformer_id,is_freeze:this.operateStatus};Object(i.f)(t).then(function(t){0===t.ret&&(e.operateStatus!==e.isNoFreezed?(e.operateSuccessTxt="冻结成功",e.suOrfa=!1):e.operateSuccessTxt="启用成功",e.isFreezeMethods=!1)}),this.searchName="",this.searchStatus="",this.getStaffListpl()},deleteStaffMethods:function(){var e=this,t={platformer_del:1,platformer_id:this.operateData.platformer_id};Object(i.f)(t).then(function(t){0===t.ret&&(e.operateSuccessTxt="删除成功")}),this.searchName="",this.searchStatus="",this.getStaffListpl()},deleteDepartMethods:function(){var e=this,t={pl_department_del:1,pl_department_id:this.operateData.pl_department_id};Object(i.b)(t).then(function(t){0===t.ret?(e.operateSuccessTxt="删除成功",e.suOrfa=!1,e.newName="",e.depart_id="",e.choosedDepartId="",e.choosedDepartName="",e.getStaffTree()):-30033===t.ret&&(e.operateFailTxt="该条目下包含数据，不能被删除",e.getStaffTree(),e.newName=e.treeNodeKey,e.getDepartStaff(e.depart_id)),e.isDeleDepart=!0})},handleSelect:function(e){this.activeIndex=e},currentChange:function(){this.isHighlight=!0},nodeExpand:function(e,t){this.isHighlight=!0;var a=t.key;this.$refs.tree.setCurrentKey(a),this.isSearch=!1,this.listQuery.page=1,this.choosedDepartId=t.data.pl_department_id,t.childNodes&&0===t.childNodes.length?(this.getDepartStaff(t.data.pl_department_id),this.choosedDepartId=t.data.pl_department_id):(this.choosedDepartId="",this.searchName="",this.searchStatus="",this.getStaffListpl())},handleNodeClick:function(e,t){this.isHighlight=!0,this.isSearch=!1,this.listQuery.page=1,this.newName=e.label,this.depart_id=e.pl_department_id,this.treeNodeKey=t.key,t.childNodes&&0===t.childNodes.length?(this.getDepartStaff(t.data.pl_department_id),this.choosedDepartId=e.pl_department_id,this.choosedDepartName=t.key):(this.$router.replace("/organzite/list"),this.choosedDepartId="",this.choosedDepartName="",this.searchName="",this.searchStatus="",this.getStaffListpl())},searchMethods:function(){this.isSearch=!0,this.listQuery.page=1,this.getStaffListpl()},handleSizeChange:function(e){this.listQuery.limit=e,this.getStaffListpl()},handleCurrentChange:function(e){this.listQuery.page=e,this.getStaffListpl()},handleModifyStatus:function(e,t){this.isFreezeMethods=!0,t!==this.isNoFreezed?(this.operateText="确定执行冻结操作？",this.isShowRedBtn=!0):(this.operateText="确定执行启用操作？",this.isShowRedBtn=!1),this.isOperate=!this.isOperate,this.operateStatus=t,this.operateData=e,this.isDeleDepart=!1,this.searchName="",this.searchStatus=""},addNewPosition:function(){this.isDetailDialog=!this.isDetailDialog},confirmAdd:function(e){var t=this;this.tipsText="新建成功!";var a={pl_department_save:1,pl_department_name:e};this.newName=e,this.departmentId&&""!==this.departmentId&&(a.pl_department_id=this.departmentId,this.tipsText="修改成功!"),this.newName=e,Object(i.b)(a).then(function(e){0===e.ret?(t.newDpaId=e.data.pl_department_id,t.depart_id=t.newDpaId,t.suOrfa=!1,t.repeat=!1,t.getStaffTree()):-20034===e.ret&&(t.suOrfa=!0,t.repeat=!0)})},dialogClose:function(){this.operateText="",this.operateSuccessTxt="",this.operateFailTxt="",this.isOperate=!1,this.isDetailDialog=!1,this.depart_id?(this.getDepartStaff(this.depart_id),this.choosedDepartId=this.depart_id):(this.choosedDepartId="",this.newName=this.staffTree[0].label,this.searchName="",this.searchStatus="",this.getStaffListpl()),this.$refs.tree.setCurrentKey(this.newName),this.isHighlight=!0},confimOper:function(){this.isFreezeMethods&&!this.isDeleDepart?this.FreezeStaffMethods():this.isFreezeMethods||this.isDeleDepart?this.isDeleDepart&&(this.deleteDepartMethods(),this.isDeleDepart=!1):this.deleteStaffMethods(),this.searchName="",this.searchStatus=""},handleDeleteBtn:function(e){this.operateData=e,this.operateText="确定删除此数据？",this.isShowRedBtn=!0,this.isOperate=!this.isOperate,this.searchName="",this.searchStatus="",this.isDeleDepart=!1},renderContent:function(e,t){var a=t.node,s=t.data,i=t.store,r=this;return e(o.a,{props:{DATA:s,NODE:a,STORE:i},on:{nodeAdd:function(e,t,a){return r.handleAdd(e,t,a)},nodeEdit:function(e,t,a){return r.handleEdit(e,t,a)},nodeDel:function(e,t,a){return r.handleDelete(e,t,a)}}})},handleAdd:function(e,t,a){this.suOrfa=!0,this.repeat=!1,a.data.pl_department_id?this.$router.push({path:"/organzite/create",query:{choosed_depart_id:this.choosedDepartId,choosed_depart_name:this.choosedDepartName}}):(this.departmentName="",a.expanded||(a.expanded=!0),this.depart_id="",this.isDetailDialog=!this.isDetailDialog)},handleEdit:function(e,t,a){this.suOrfa=!0,this.departmentName=a.data.label,this.departmentId=a.data.pl_department_id,this.isDetailDialog=!this.isDetailDialog,this.treeNodeKey=a.data.label},handleDelete:function(e,t,a){this.treeNodeKey=a.data.label,this.operateData=a.data,this.operateText="确定删除此部门？",this.isShowRedBtn=!0,this.isOperate=!this.isOperate,this.isDeleDepart=!0}}}}).call(t,a("tra3"))},vBJn:function(e,t){}});